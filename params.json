{"name":"Eistarapi","tagline":"a api for eistar bbs.","body":"eistarapi\r\n=========\r\n\r\nprovide api for eistar bbs.\r\n\r\n实际上这仅仅是个代理，所有数据从 http://www.dian.org.cn:81 获取，服务器无数据库，因此不会保存任何用户数据~\r\n\r\n注意，权限与论坛一致，隐藏板块只有用具有权限的帐号登录才可见。\r\n\r\nPowered by Ruby, Sinatra, Nokogiri, httparty\r\n\r\n\r\nAPI Document\r\n=========\r\n\r\n## Session\r\n\r\n用户登录通过创建session进行，使用正确的用户名密码创建一个session成功，即为登录成功。\r\n服务器会在返回的HTTP头中设置set-cookies字段，或者你也可以利用返回结果手动设置你下次请求的cookie。\r\n\r\n\r\n删除session即为登出，当然实际上eistar的服务器上应该并没有销毁登录，它只会通过session的超时来销毁。\r\n\r\n\r\n### create a session (e.q. login)\r\n\r\n```\r\nPOST /session\r\n```\r\n\r\n#### request body\r\n```json\r\n{\r\n  \"username\": \"houkanshan\",\r\n  \"password\": \"passwordxxx\"\r\n}\r\n```\r\n\r\n#### response body\r\n```json\r\n{\r\n  \"set_cookie\": {\r\n    \"utmpkey\": 1111111,\r\n    \"utmpnum\": 2,\r\n    \"utmpuserid\": \"houkanshan\"\r\n  }\r\n}\r\n```\r\n\r\n### delete a session (e.q. logout)\r\n\r\n```\r\nDELETE /session\r\n```\r\n\r\n#### response body\r\n```json\r\n{\r\n  \"set_cookie\" {\r\n    \"utmpkey\": \"\",\r\n    \"utmpnum\": \"\",\r\n    \"utmpuserid\": \"\"\r\n  }\r\n}\r\n```\r\n\r\n## User\r\n\r\n用户接口主要提供用户信息\r\n\r\n### get a user's info\r\n\r\n获取某用户信息\r\n\r\n```\r\nGET /users/:id\r\n```\r\n\r\n#### response body\r\n```json\r\n{\r\n    \"id\": \"houks\",\r\n    \"name\": \"呵呵\",\r\n    \"login_count\": \"1207\",\r\n    \"post_count\": \"372\",\r\n    \"constellation\": \"天蝎座\",\r\n    \"last_login\": {\r\n        \"time\": \"Wed Feb 27 13:28:49 2013\",\r\n        \"from\": \"192.168.7.89\"\r\n    },\r\n    \"exp\": {\r\n        \"num\": \"2100\",\r\n        \"title\": \"老站友\"\r\n    },\r\n    \"hp\": {\r\n        \"num\": \"179\"\r\n    },\r\n    \"perf\": {\r\n        \"num\": \"18\",\r\n        \"title\": \"还不错\"\r\n    }\r\n}\r\n```\r\n\r\n## Board\r\n\r\nBBS 版块接口\r\n\r\n### get boards list\r\n\r\n获取所有可见版块\r\n\r\n```\r\nGET /boards\r\n```\r\n\r\n#### response body\r\n```json\r\n[\r\n    {\r\n        \"name\": \"Weather\",\r\n        \"category\": \"生活\",\r\n        \"title\": \"天气预报\",\r\n        \"admin\": \"SYSOPs\"\r\n    },\r\n    {\r\n        \"name\": \"Wishes\",\r\n        \"category\": \"交流\",\r\n        \"title\": \"温馨祝福\",\r\n        \"admin\": \"STONE\"\r\n    }\r\n]\r\n```\r\n\r\n### get a board's info\r\n\r\n获取某版块信息\r\n\r\n```\r\nGET /boards/:boardname\r\n```\r\n\r\n#### response body\r\n```json\r\n{\r\n    \"title\": \"Weather(天气预报)\",\r\n    \"admin\": \"SYSOPs\",\r\n    \"name\": \"Weather\",\r\n    \"note\": \"\"\r\n}\r\n```\r\n\r\n\r\n## Topic \r\n\r\n版块在主题模式下的内容\r\n\r\n### get topics list\r\n\r\n获取某版块的主题列表\r\n\r\n```\r\nGET /boards/:boardname/topics\r\n```\r\n#### request body\r\n\r\n可选参数，默认为start=0, count=20\r\n\r\n```json\r\n{\r\n  \"start\": 0,  // optional, default 0\r\n  \"count\": 2, // optional, default 20\r\n}\r\n```\r\n\r\n#### response body\r\n```json\r\n[\r\n    {\r\n        \"filename\": \"M.1355479789.A\",\r\n        \"index\": \"1\",\r\n        \"author\": {\r\n            \"id\": \"warren\"\r\n        },\r\n        \"date\": \"Dec 14 18:09\",\r\n        \"title\": \"好冷，这是要下雪的节奏吗\"\r\n    },\r\n    {\r\n        \"filename\": \"M.1347623570.A\",\r\n        \"index\": \"2\",\r\n        \"author\": {\r\n            \"id\": \"candycao\"\r\n        },\r\n        \"date\": \"Sep 14 19:52\",\r\n        \"title\": \"武汉温差\"\r\n    }\r\n]\r\n```\r\n\r\n### get a topic\r\n\r\n获取某个主题的内容，主题通过 boardname + filename 索引（bbs实际上是通过文件来存储帖子）\r\n```\r\nGET /boards/:boardname/topics/:filename\r\n```\r\n\r\n#### response body\r\n```json\r\n[\r\n    {\r\n        \"author\": {\r\n            \"id\": \"warren\",\r\n            \"name\": \"warren\"\r\n        },\r\n        \"border\": \"Weather\",\r\n        \"title\": \"好冷，这是要下雪的节奏吗\",\r\n        \"date\": \"2012年12月14日18:09:48 星期五\",\r\n        \"filename\": \"M.1355479789.A\",\r\n        \"text\": \"xxxx\",\r\n        \"from\": \"xxx.xxx.xxx.xxx\"\r\n    }\r\n]\r\n\r\n```\r\n\r\n## Post\r\n\r\n版块在帖子模式下的内容，以及对单个帖子的相关功能\r\n\r\n### get posts list\r\n```\r\nGET /boards/:boardname/posts\r\n```\r\n#### request body\r\n\r\n可选参数，默认为start=0, count=20\r\n\r\n```json\r\n{\r\n  \"start\": 0,  // optional, default 0\r\n  \"count\": 2, // optional, default 20\r\n}\r\n```\r\n\r\n#### response body\r\n```json\r\n[\r\n    {\r\n        \"filename\": \"M.1361195402.A\",\r\n        \"index\": \"1811\",\r\n        \"author\": {\r\n            \"id\": \"houks\"\r\n        },\r\n        \"date\": \"Feb 18 21:50\",\r\n        \"title\": \"Re: 该穿中袖了么~\",\r\n        \"size\": \"16\"\r\n    },\r\n    {\r\n        \"filename\": \"M.1361193048.A\",\r\n        \"index\": \"1810\",\r\n        \"author\": {\r\n            \"id\": \"houks\"\r\n        },\r\n        \"date\": \"Feb 18 21:10\",\r\n        \"title\": \"Re: test\",\r\n        \"size\": \"22\"\r\n    }\r\n]\r\n```\r\n\r\n### get a post\r\n\r\n获取某个帖子的内容\r\n\r\n```\r\nGET /boards/:boardname/posts/:filename\r\n```\r\n#### response body\r\n```json\r\n{\r\n    \"author\": {\r\n        \"id\": \"houks\",\r\n        \"name\": \"呵呵\"\r\n    },\r\n    \"border\": \"Weather\",\r\n    \"title\": \"Re: test\",\r\n    \"date\": \"Mon Feb 18 21:10:48 2013\",\r\n    \"filename\": \"M.1361193048.A\",\r\n    \"text\": \"xxx\",\r\n    \"from\": \"xxx.xx.xx.xx\"\r\n}\r\n```\r\n### create a post\r\n\r\n创建一个帖子\r\n\r\n```\r\nPOST /boards/:boardname/posts\r\n```\r\n\r\n#### request body\r\n\r\ntitle参数必需，text参数可选\r\n\r\n```json\r\n{\r\n  \"title\": \"test_title\",\r\n  \"text\": \"test_content\"   // optional, default ''\r\n}\r\n```\r\n\r\n#### response body\r\n\r\n```json\r\n{\r\n    \"author\": {\r\n        \"id\": \"houks\",\r\n        \"name\": \"呵呵\"\r\n    },\r\n    \"border\": \"Weather\",\r\n    \"title\": \"test_title\",\r\n    \"date\": \"Wed Feb 27 14:26:56 2013\",\r\n    \"filename\": \"M.1361946416.A\",\r\n    \"text\": \"xxx\",\r\n    \"from\": \"x.x.x.x\"\r\n}\r\n```\r\n\r\n### edit a post\r\n\r\n编辑帖子\r\n```\r\nPUT /boards/:boardname/posts/:filename\r\n```\r\n\r\n#### request body\r\n```json\r\n{\r\n  \"text\": \"change you~!\"\r\n}\r\n```\r\n\r\n\r\n### delete a post\r\n\r\n删除帖子\r\n```\r\nDELETE /boards/:boardname/posts/:filename\r\n```\r\n\r\n#### response body\r\n{\r\n    \"code\": 100,\r\n    \"msg\": \"successed ~\",\r\n    \"detail\": \"删除成功.\"\r\n}\r\n\r\n### reply a post\r\n\r\n回复帖子\r\n```\r\nPOST /boards/:boardname/posts/:filename/reply\r\n```\r\n\r\n#### request body\r\n```json\r\n{\r\n  \"text\": \"this is a reply ~\"\r\n}\r\n```\r\n\r\n#### response body\r\n```json\r\n{\r\n    \"author\": {\r\n        \"id\": \"houks\",\r\n        \"name\": \"呵呵\"\r\n    },\r\n    \"border\": \"Weather\",\r\n    \"title\": \"Re: test_title\",\r\n    \"date\": \"Wed Feb 27 14:30:56 2013\",\r\n    \"filename\": \"M.13619464123.A\",\r\n    \"text\": \"xxx\",\r\n    \"from\": \"x.x.x.x\"\r\n}\r\n```\r\n\r\n\r\n### cc a post\r\n\r\n转发帖子\r\n```\r\nPOST /boards/:boardname/posts/:filename/cc\r\n```\r\n#### request body\r\n\r\nto为被转发到的版块\r\n```json\r\n{\r\n  \"to\": \"Water\"\r\n}\r\n```\r\n\r\n#### response body\r\n```json\r\n{\r\n    \"author\": {\r\n        \"id\": \"houks\",\r\n        \"name\": \"呵呵\"\r\n    },\r\n    \"border\": \"Weather\",\r\n    \"title\": \"[转载] Re: 该穿中袖了么~\",\r\n    \"date\": \"Wed Feb 27 14:37:15 2013\",\r\n    \"filename\": \"M.1361947035.A\",\r\n    \"text\": \"【 以下文字转载自 Weather 讨论区 】\\n【 原文由 candycao 所发表 】xxx\",\r\n    \"from\": \"x.x.x.x\"\r\n}\r\n```\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}